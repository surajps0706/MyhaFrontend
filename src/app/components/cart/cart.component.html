<div class="cart-container" *ngIf="cartItems.length > 0">

  <!-- Header -->
  <div class="cart-header">
    <h2 class="cart-heading">
      <span class="material-icons cart-icon">shopping_bag</span>
      Your Cart
    </h2>
    <button class="clear-cart-btn" (click)="clearCart()">
      <span class="material-icons">delete_forever</span>
      Clear All
    </button>
  </div>

  <!-- Items -->
  <div class="cart-items">
    <div class="cart-item" *ngFor="let item of cartItems; let i = index">

      <!-- Product Image -->
      <div class="image-wrapper">
        <img [src]="item.images[0]" alt="{{ item.name }}" class="product-image" />
      </div>

      <!-- Product Details -->
      <div class="cart-details">

        <!-- Title + Price -->
        <div class="title-price-row">
          <h3 class="product-title">{{ item.name }}</h3>
          <span class="item-total">
            ₹{{ (item.price + (item.sleevePrice || 0) + (item.extraHeightPrice || 0)) * item.quantity }}
          </span>
        </div>

        <!-- Quantity -->
        <div class="quantity-row">
          <label>Qty:</label>
          <div class="qty-control">
            <button (click)="updateQuantity(i, item.quantity - 1)" [disabled]="item.quantity <= 1">−</button>
            <span>{{ item.quantity }}</span>
            <button (click)="updateQuantity(i, item.quantity + 1)">+</button>
          </div>
        </div>

        <!-- Tags for Customization -->
      <div class="customization-tags">
  <span class="tag" *ngIf="item.selectedSize">Size: {{ item.selectedSize }}</span>
    <span class="tag" *ngIf="item.selectedSleeve">Sleeve: {{ item.selectedSleeve ? 'Yes' : 'No'}}</span>
  <span style="display: flex;" class="tag">Height: {{ item.hasHeightCustomization ? 'Yes' : 'No' }}</span>
  <span class="tag">Neck: {{ item.hasNeckCustomization ? 'Yes' : 'No' }}</span>
  <span
    style="display: flex;"
    class="tag"
    *ngIf="item.sleeveType"
  >
    Sleeve: {{ item.sleeveType }}
    <span *ngIf="item.sleevePrice > 0">+₹{{ item.sleevePrice }}</span>
  </span>
</div>


        <!-- Measurements -->
        <div class="measurement-summary" *ngIf="hasMeasurements(item.measurements)">
          <h4>Measurements:</h4>
          <div class="measurement-tags">
            <ng-container *ngFor="let key of objectKeys(item.measurements)">
              <span class="tag" *ngIf="item.measurements[key]?.trim()">
                {{ key }}: {{ item.measurements[key] }}
              </span>
            </ng-container>
          </div>
        </div>

        <!-- Notes -->
        <p class="custom-notes" *ngIf="item.customizationNotes">
          <strong>Notes:</strong> {{ item.customizationNotes }}
        </p>

        <!-- Remove -->
        <button class="remove-btn" (click)="removeItem(i)">
          <span class="material-icons">delete_outline</span>
          Remove
        </button>
      </div>
    </div>
  </div>

  <!-- Totals -->
  <div class="cart-total">
    <h3 class="summary-heading">Order Summary</h3>
<div class="price-breakup">
  <p><span>Base Price:</span> ₹{{ baseTotal }}</p>
  <p><span>Sleeve Add-ons:</span> ₹{{ sleeveTotal }}</p>
  <p *ngIf="heightTotal > 0" class="height-total-line">
    <span>Height Customization:</span> ₹{{ heightTotal }}</p>

  <!-- ✅ Handling charge display -->
  <!-- <p *ngIf="handlingCharge > 0" class="handling-charge-line">
    <span>Handling Charge:</span> ₹{{ handlingCharge }}
  </p> -->

  <hr />
  <p class="grand-total"><span>Grand Total:</span> ₹{{ total }}</p>
</div>


    <button class="pay-btn"
            [disabled]="cartItems.length === 0"
            (click)="goToCheckout()">
      Proceed to Checkout →
    </button>
  </div>
</div>
