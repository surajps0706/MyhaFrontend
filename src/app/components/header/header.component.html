<header class="header">
  <!-- Logo -->
  <div class="logo">
    <a routerLink="/">
      <img
        src="https://res.cloudinary.com/dfftrjswl/image/upload/v1767177307/logo1_ckjoqd.jpg"
        alt="Myha Logo"
      />
    </a>
  </div>

  <!-- Desktop Navigation -->
  <nav class="nav-links">
    <a
      routerLink="/"
      routerLinkActive="active-link"
      [routerLinkActiveOptions]="{ exact: true }"
      >Home</a
    >
    <a routerLink="/products" routerLinkActive="active-link">Shop</a>
    <a routerLink="/track" routerLinkActive="active-link">Track Order</a>
  </nav>

  <!-- Search Bar -->
  <div class="search-bar" *ngIf="showSearchBar">
    <input
      type="text"
      placeholder="Search for products..."
      (input)="onSearch($event)"
      [(ngModel)]="searchQuery"
    />
    <button aria-label="Search">ğŸ”</button>

    <!-- Suggestions -->
    <div class="suggestions" *ngIf="suggestions.length > 0">
      <div
        class="suggestion-item"
        *ngFor="let product of suggestions"
        [routerLink]="['/product', product.id]"
        (click)="clearSuggestions()"
      >
        <img [src]="product.images[0]" alt="{{ product.name }}" />
        <div class="info">
          <span class="name">{{ product.name }}</span>
          <span class="price">{{ product.price }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Section -->
  <div class="right-section">

    <!-- Wishlist -->
    <a class="wishlist-icon" routerLink="/wishlist" aria-label="Wishlist">
      <span class="icon">â¤ï¸</span>
      <span class="badge" *ngIf="wishlistCount > 0">{{ wishlistCount }}</span>
    </a>

    <!-- Cart -->
    <a class="cart-icon" routerLink="/cart" aria-label="Cart">
      <span class="icon">ğŸ›’</span>
      <span class="badge" *ngIf="cartCount > 0">{{ cartCount }}</span>
    </a>

    <!-- Login / Username -->
    <ng-container *ngIf="!isLoggedIn; else loggedInBlock">
      <a routerLink="/login" class="login-link">Login</a>
    </ng-container>

    <!-- When logged in -->
    <ng-template #loggedInBlock>
      <span class="user-name">Hi, {{ userName }}</span>
      <button class="logout-btn" (click)="logout()">Logout</button>
    </ng-template>

    <!-- Hamburger Menu -->
    <button
      class="hamburger"
      [class.open]="isMobileMenuOpen"
      (click)="toggleMenu()"
      aria-label="Toggle Menu"
    >
      <span></span><span></span><span></span>
    </button>
  </div>
</header>

<!-- Backdrop -->
<div
  class="mobile-menu-backdrop"
  *ngIf="isMobileMenuOpen"
  (click)="toggleMenu()"
></div>

<!-- Mobile Menu -->
<div class="mobile-menu" [class.open]="isMobileMenuOpen">
  <div class="mobile-menu-header">
    <h3>Menu</h3>
    <span class="close-btn" (click)="toggleMenu()">âœ•</span>
  </div>

  <!-- Mobile Search -->
  <div class="mobile-search">
    <div class="input-wrapper">
      <input
        type="text"
        placeholder="Search products..."
        (input)="onSearch($event)"
        [(ngModel)]="searchQuery"
      />
      <button aria-label="Search">ğŸ”</button>
    </div>

    <div class="suggestions" *ngIf="suggestions.length > 0">
      <div
        class="suggestion-item"
        *ngFor="let product of suggestions"
        [routerLink]="['/product', product.id]"
        (click)="clearSuggestions(); toggleMenu()"
      >
        <img [src]="product.images[0]" alt="{{ product.name }}" />
        <div class="info">
          <span class="name">{{ product.name }}</span>
          <span class="price">{{ product.price }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Navigation -->
  <a routerLink="/" (click)="toggleMenu()">Home</a>
  <a routerLink="/products" (click)="toggleMenu()">Shop</a>
  <a routerLink="/track" (click)="toggleMenu()">Track Order</a>
  <a routerLink="/wishlist" (click)="toggleMenu()">
    Wishlist â¤ï¸ <span *ngIf="wishlistCount > 0">({{ wishlistCount }})</span>
  </a>
  <a routerLink="/cart" (click)="toggleMenu()">
    Cart ğŸ›’ <span *ngIf="cartCount > 0">({{ cartCount }})</span>
  </a>

  <!-- Mobile Login / Logout -->
  <ng-container *ngIf="!isLoggedIn; else mobileLoggedIn">
    <a routerLink="/login" (click)="toggleMenu()">Login</a>
  </ng-container>

  <ng-template #mobileLoggedIn>
    <span class="mobile-user-name">Hi, {{ userName }}</span>
    <a (click)="logout(); toggleMenu()">Logout</a>
  </ng-template>
</div>
