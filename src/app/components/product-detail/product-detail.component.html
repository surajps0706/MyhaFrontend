<div class="product-detail-container">
  <!-- Left: Image Section -->
  <div class="image-section">
    <div class="thumbnails">
      <img *ngFor="let img of product.images"
           [src]="img"
           [alt]="product.name"
           (click)="selectImage(img)"
           [class.active]="img === selectedImage" />
    </div>
    <div class="main-image">
      <img [src]="selectedImage" [alt]="product.name" />
    </div>
  </div>

  <!-- Right: Info Section -->
  <div class="info-section">
    <h2>{{ product.name }}</h2>

    <!-- Price -->
    <div class="price-container">
      <span class="price-label">Price:</span>
      <span class="price-value">{{ product.price }}</span>
    </div>

    <!-- Collapsible Description -->
    <div class="collapsible-description">
      <button class="toggle-btn" (click)="toggleDescription()">
        {{ showDescription ? 'Hide' : 'Show' }} Description
        <span [class.rotated]="showDescription">‚ñº</span>
      </button>
     <div class="description-content" [class.open]="showDescription" [innerHTML]="formattedDescription"></div>

    </div>

<!-- Size Selection -->
<div class="select-row">
  <label for="size">Size:</label>
  <select id="size" class="size-dropdown" [(ngModel)]="product.selectedSize">
    <option *ngFor="let size of standardSizes" [value]="size">{{ size }}</option>
  </select>

  <div class="size-chart-link" (click)="showSizeChart = !showSizeChart">üìè View Size Chart</div>
  <div class="size-chart-img" *ngIf="showSizeChart">
    <img src="https://res.cloudinary.com/dw35epojg/image/upload/v1754143979/size-chart_bu3k4d.jpg" alt="Size chart" />
  </div>
</div>


    <!-- Measurements -->
    <div class="measurements-section">
      <h4>Measurements:</h4>
      <div class="measurements-grid">
        <div class="measurement-row" *ngFor="let field of measurementFields">
          <label>
            {{ field.label }}
            <span *ngIf="isRequired(field.key)" class="required-star">*</span>
          </label>
          <input
            type="text"
            [(ngModel)]="measurements[field.key]"
            [name]="field.key"
            placeholder="in inches"
            [required]="isRequired(field.key)"
            #inputRef="ngModel"
            [ngClass]="{ 'invalid': isRequired(field.key) && inputRef.invalid && inputRef.touched }"
            (blur)="inputRef.control.markAsTouched()"
          />
          <div *ngIf="isRequired(field.key) && inputRef.invalid && inputRef.touched" class="error-msg">
            {{ field.label }} is required
          </div>
        </div>
      </div>
    </div>

    <!-- Sleeve Selection -->
    <div class="sleeve-options">
      <h4>Sleeve Type:</h4>
      <div class="sleeve-list">
        <label *ngFor="let option of sleeveOptions">
          <input
            type="radio"
            name="sleeve"
            [value]="option"
            [(ngModel)]="selectedSleeve"
          />
          {{ option.name }} ({{ option.price > 0 ? '+‚Çπ' + option.price : 'Free' }})
        </label>
      </div>
    </div>

   <div *ngIf="isKurti" class="extra-height-section">
  <h4>Extra Height (‚Çπ{{ extraHeightPrice }})</h4>
  <input class="extra-height"
         type="text"
         [(ngModel)]="preferredHeight"
         (ngModelChange)="onHeightChange($event)"
         placeholder="Enter desired height in inches" />
  <p class="extra-height-note">
    *Extra ‚Çπ150 will be charged if height exceeds 35 inches.
  </p>
</div>


    <!-- Customization Notes -->
    <div class="customization-section">
      <h4>Customization Notes <span class="optional-text">(Optional)</span></h4>
      <p class="customization-hint">Mention preferences like neck style, height, or additional comments.</p>
      <textarea
        rows="3"
        [(ngModel)]="customizationNotes"
        placeholder="e.g., V-neck preferred, height 42 inches"
      ></textarea>
    </div>

    <!-- Sticky Footer -->
    <div class="sticky-footer" *ngIf="product">
      <div class="footer-content">
        <div class="footer-price">
          <p>
            Base Price: ‚Çπ{{ basePrice }}
            <span *ngIf="sleeveExtra"> + ‚Çπ{{ sleeveExtra }}</span>
            <span *ngIf="heightExtra"> + ‚Çπ{{ heightExtra }}</span>
            <span *ngIf="sleeveExtra || heightExtra"> = ‚Çπ{{ totalPrice }}</span>
          </p>
        </div>

        <button
          class="footer-add-btn"
          type="button"
          [disabled]="!isFormValid()"
          (click)="addToCart()"
        >
          Add to Cart
        </button>

        <!-- WhatsApp Floating Button -->
<a
  class="whatsapp-float"
  [href]="getWhatsappLink()"
  target="_blank"
  rel="noopener noreferrer"
  aria-label="Chat on WhatsApp"
>
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" />
</a>

      </div>
    </div>
  </div>
</div>
