<div class="checkout-container" *ngIf="cartItems.length > 0; else emptyCart">
  <h2 class="checkout-title">üõí Secure Checkout</h2>

  <div class="checkout-wrapper">
    <!-- Billing Form -->
    <form class="billing-form section" (ngSubmit)="placeOrder()" #checkoutForm="ngForm">
      <fieldset>
        <legend>Billing Details</legend>

        <div class="form-group">
          <label>Full Name *</label>
          <input type="text" [(ngModel)]="checkoutData.name" name="name" required placeholder="John Doe" />
        </div>

        <div class="form-group">
          <label>Phone *</label>
          <input type="tel" [(ngModel)]="checkoutData.phone" name="phone" required placeholder="9876543210" />
        </div>

        <div class="form-group">
          <label>Email *</label>
          <input type="email" [(ngModel)]="checkoutData.email" name="email" required placeholder="john@example.com" />
        </div>

        <div class="form-group">
          <label>Address Line 1 *</label>
          <input type="text" [(ngModel)]="checkoutData.addressLine1" name="address1" required placeholder="Street, Area" />
        </div>

        <div class="form-group">
          <label>Address Line 2</label>
          <input type="text" [(ngModel)]="checkoutData.addressLine2" name="address2" placeholder="Apartment, Landmark" />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>City</label>
            <input type="text" required [(ngModel)]="checkoutData.city" name="city" />
          </div>
          <div class="form-group">
            <label>State</label>
            <input type="text" required [(ngModel)]="checkoutData.state" name="state" />
          </div>
          <div class="form-group">
            <label>Pincode</label>
            <input type="text"
                   required
                   [(ngModel)]="checkoutData.pincode"
                   name="pincode"
                   (blur)="onPincodeChange()" />
          </div>
        </div>
      </fieldset>

  
    </form>

    <!-- Order Summary -->
    <aside class="order-summary section">
      <h3>üõçÔ∏è Order Summary</h3>

      <div *ngFor="let item of cartItems" class="summary-item">
        <div class="item-image">
          <img [src]="item.images[0]" [alt]="item.name" />
        </div>
        <div class="item-details">
          <strong>{{ item.name }}</strong>
          <div class="item-meta">
            <span *ngIf="item.selectedSize">Size: {{ item.selectedSize }}</span>
            <span *ngIf="item.sleeveType">Sleeve: {{ item.sleeveType }} (+‚Çπ{{ item.sleevePrice }})</span>
            <span *ngIf="item.extraHeightPrice">Height: +‚Çπ{{ item.extraHeightPrice }}</span>
            <span *ngIf="item.preferredHeight">Height : {{ item.preferredHeight }} inches (Free of Cost)</span>
            <span *ngIf="item.customizationNotes">Customization Notes: {{item.customizationNotes}}</span>
          </div>
        </div>
      </div>

      <hr />
      <div class="summary-total">
        <span>Subtotal:</span>
        <strong>‚Çπ{{ totalAmount }}</strong>
      </div>

      <div class="summary-total">
        <span>Delivery:</span>
        <strong *ngIf="shippingCost">‚Çπ{{ shippingCost }}</strong>
        <strong *ngIf="!shippingCost">‚Äî</strong>
      </div>

      <div class="summary-total grand-total">
        <span>Total Payable:</span>
        <strong class="total-amount">‚Çπ{{ grandTotal || totalAmount }}</strong>
      </div>

       <button type="submit" class="place-order-btn">
        Proceed to Pay
      </button>

      <p class="secure-note">All payments are 100% secure & encrypted via Razorpay.</p>
    </aside>
  </div>
</div>

<ng-template #emptyCart>
  <p class="empty-message">üõí Your cart is empty. Add some items before proceeding to checkout.</p>
</ng-template>
