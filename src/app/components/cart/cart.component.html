<div class="cart-container" *ngIf="cartItems.length > 0">

  <div class="cart-header">
    <h2 class="cart-heading">Your Cart</h2>
    <button class="clear-cart-btn" (click)="clearCart()">
      <span class="material-icons">delete_outline</span>
      Clear Cart
    </button>
  </div>

  <div class="cart-item" *ngFor="let item of cartItems; let i = index">
    <div class="image-wrapper">
      <img [src]="item.images[0]" alt="{{ item.name }}" class="product-image" />
    </div>

    <div class="cart-details">
      <h3 class="product-title">{{ item.name }}</h3>
      <p class="price">Price: {{ item.price }}</p>

      <div class="quantity-row">
        <label>Quantity:</label>
        <select [(ngModel)]="item.quantity" (change)="updateQuantity(i, item.quantity)">
          <option *ngFor="let qty of [1,2,3,4,5,6,7,8,9,10]" [value]="qty">{{ qty }}</option>
        </select>
      </div>

      <p class="size">Selected Size: <span>{{ item.selectedSize }}</span></p>

      <div class="measurement-summary" *ngIf="hasMeasurements(item.measurements)">
        <h4>Measurements:</h4>
        <div class="measurement-tags">
          <ng-container *ngFor="let key of objectKeys(item.measurements)">
            <span *ngIf="item.measurements[key]?.trim()">
              {{ key }}: {{ item.measurements[key] }}
            </span>
          </ng-container>
        </div>
      </div>

      <p class="sleeve">Selected Sleeve: <span>{{ item.sleeveType }}</span> (+₹{{ item.sleevePrice }})</p>

      <p *ngIf="item.preferredHeight">Preferred Height: <span>{{ item.preferredHeight }} inches</span>
  <span *ngIf="item.extraHeightPrice > 0"> (+₹{{ item.extraHeightPrice }})</span>
</p>

<p class="custom-notes" *ngIf="item.customizationNotes">
  <strong>Customization Notes:</strong> {{ item.customizationNotes }}
</p>





      <button class="remove-btn" (click)="removeItem(i)" title="Remove this item">
        <span class="material-icons">delete_outline</span>
        <span>Remove</span>
      </button>
    </div>
  </div>

  <div class="cart-total">
    <div class="price-breakup">
      <p><span>Base Price Total:</span> ₹{{ baseTotal }}</p>
      <p><span>Sleeve Price Total:</span> ₹{{ sleeveTotal }}</p>
      <p *ngIf="heightTotal > 0" class="height-total-line">Height Customization Total: ₹{{ heightTotal }}</p>
      <hr />
      <p class="grand-total"><span>Grand Total:</span> ₹{{ total }}</p>
    </div>

    <button class="pay-btn" 
            [disabled]="cartItems.length === 0"
            (click)="goToCheckout()">
      Proceed to Checkout
    </button>
  </div>

</div>
